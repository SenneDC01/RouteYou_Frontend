default:
  image: ubuntu
  tags:
    - atpFrontendRunner

stages:
  - buildSite
  - buildImage

build_site:
  stage: buildSite
  only:
    - ci-cd  # Adjust the branch name to trigger the pipeline
  image: $NODE_IMAGE
  script:
    - ls -al
    - npm install
    - npm run build 
    - ls -al
  artifacts: 
    paths:
      - ".next"

build_image:
  stage: buildImage
  only:
    - ci-cd  # Adjust the branch name to trigger the pipeline
  image: $DOCKER_IMAGE
  script:
    - ls -all
    - echo "FROM nginx:latest" > Dockerfile  
    - echo "COPY .next /usr/share/nginx/html/.next" >> Dockerfile  
    - echo "COPY custom.conf /etc/nginx/conf.d/custom.conf" >> Dockerfile  
    - echo "RUN rm /etc/nginx/conf.d/default.conf" >> Dockerfile  
    - cat Dockerfile
    
    





